:root {
  --bg: #f7f8fb;
  --card: #ffffff;
  --muted: #6b7280;
  --accent: #0ea5e9;
  --accent-2: #7c3aed;
  --danger: #ef4444;
  --glass: rgba(255, 255, 255, 0.6);
}

* {
  box-sizing: border-box;
}
body,
html,
#root {
  height: 100%;
}
body {
  font-family: Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto,
    "Helvetica Neue", Arial;
  margin: 0;
  min-height: 100vh;
  background-color: var(--bg);
  /* background: linear-gradient(180deg, #eef2ff 0%, #f8fafc 100%); */
  color: #0f172a;
  /* Prevent unwanted zoom on mobile */
  touch-action: manipulation;
  -webkit-text-size-adjust: 100%;
  -moz-text-size-adjust: 100%;
  text-size-adjust: 100%;
}

.app-root {
  max-width: 1100px;
  margin: 24px auto;
  padding: 20px;
  /* Prevent zoom issues on mobile */
  width: 100%;
  box-sizing: border-box;
}

/* (layout centering removed - using original top-aligned flow) */
header {
  display: flex;
  flex-direction: column;
  gap: 6px;
  align-items: flex-start;
}
header h1 {
  margin: 0;
  font-size: 1.6rem;
}
.subtitle {
  margin: 0;
  color: var(--muted);
}

.calculator {
  display: grid;
  grid-template-columns: 1fr 420px;
  gap: 20px;
  margin-top: 18px;
}
.inputs {
  background: var(--card);
  padding: 18px;
  border-radius: 12px;
  box-shadow: 0 6px 20px rgba(2, 6, 23, 0.06);
  display: flex;
  flex-direction: column;
  flex-wrap: wrap;
}
.results {
  background: linear-gradient(
    180deg,
    rgba(124, 58, 237, 0.06),
    rgba(14, 165, 233, 0.02)
  );
  padding: 18px;
  border-radius: 12px;
}

.row {
  display: flex;
  gap: 12px;
}
/* Allow flex children (labels/inputs) to shrink on small viewports */
.row label {
  min-width: 0;
}
label {
  flex: 1;
  display: flex;
  flex-direction: column;
  font-size: 0.95rem;
}
input {
  margin-top: 8px;
  padding: 10px 12px;
  border-radius: 8px;
  border: 1px solid #e6e9ef;
  background: #fff;
  color: #0f172a;
}
select,
input,
.adj-label,
.adj-amount,
.adj-note {
  max-width: 100%;
  min-width: 0; /* important for flex children to allow shrinking */
  box-sizing: border-box;
}
input::placeholder {
  color: #c7cbd6;
}

.adjustments {
  margin-top: 14px;
}
.adjustments-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
}
.muted {
  color: var(--muted);
  font-size: 0.9rem;
}
.adj-row {
  display: flex;
  gap: 8px;
  margin-top: 10px;
  align-items: center;
}
.adj-note {
  flex: 1.5;
  padding: 8px;
  border-radius: 8px;
  border: 1px solid #e6e9ef;
  background: #fff;
}
.adj-label {
  flex: 1;
  padding: 8px;
  border-radius: 8px;
  border: 1px solid #e6e9ef;
}
.adj-amount {
  width: 120px;
  padding: 8px;
  border-radius: 8px;
  border: 1px solid #e6e9ef;
}

.adj-label,
.adj-amount,
.adj-row select {
  background: #fff;
  color: #0f172a;
}

.summary-header {
  padding: 6px 0;
}

/* Print format visual (also visible on screen) */
.print-format {
  font-family: "Times New Roman", serif;
  color: #000;
  -webkit-print-color-adjust: exact;
  print-color-adjust: exact;
}
.print-format .print-lines {
  padding: 8px;
  line-height: 1.4;
  font-size: 14px;
}
.pl-row {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 4px 0;
}
.pl-row.header {
  font-weight: 800;
  font-size: 16px;
  margin-bottom: 6px;
}
.pl-left {
  text-align: left;
}
.pl-right {
  text-align: right;
}
.pl-sep {
  border-top: 1px solid #000;
  height: 0;
  margin: 6px 0;
}
.pl-row.amount .pl-left {
  font-size: 16px;
  font-weight: 800;
}
.pl-row.final .pl-left {
  font-size: 16px;
  font-weight: 900;
}
.pl-row.final-dup {
  font-size: 16px;
  font-weight: 900;
}
.pl-row.zeros {
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, "Roboto Mono",
    "Courier New", monospace;
}

.pl-row.adj-note-row .pl-left {
  font-size: 12px;
  color: var(--muted);
  font-style: italic;
}

/* Ensure print wrapper looks correct on screen and print */
.print-wrapper {
  background: #fff;
  padding: 8px;
  border-radius: 6px;
  /* base print font size and scale variables */
  --print-font-size: 14px;
  --print-font-scale: 1;
  --print-scale: 1;
  font-size: calc(var(--print-font-size) * var(--print-font-scale));
  transform-origin: top left;
  transform: scale(var(--print-scale));
}

.adj-row select {
  padding: 8px;
  border-radius: 6px;
  border: 1px solid #e6e9ef;
  background: white;
}

.print-controls select {
  padding: 6px;
  border-radius: 6px;
  border: 1px solid #e6e9ef;
}

.print-wrapper {
  transform-origin: top left;
}

.btn {
  background: var(--accent);
  color: white;
  padding: 8px 12px;
  border-radius: 8px;
  border: none;
  cursor: pointer;
}
.btn.small {
  padding: 6px 10px;
  font-size: 0.9rem;
}
.btn.danger {
  background: var(--danger);
}

.result-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 12px;
}
.result-item {
  background: rgba(255, 255, 255, 0.9);
  padding: 12px;
  border-radius: 8px;
  box-shadow: 0 2px 8px rgba(2, 6, 23, 0.04);
}
.result-item.full {
  grid-column: 1/-1;
}
.label {
  color: var(--muted);
  font-size: 0.9rem;
}
.value {
  font-weight: 700;
  margin-top: 6px;
}
.currency {
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, "Roboto Mono",
    "Courier New", monospace;
}

.final-display {
  margin-top: 14px;
  background: rgba(255, 255, 255, 0.95);
  padding: 12px;
  border-radius: 8px;
}
.final-display .line {
  display: flex;
  justify-content: space-between;
  padding: 6px 0;
}
.final-display .line.small {
  font-size: 0.95rem;
  color: var(--muted);
}
.final-display .line.note {
  padding-top: 0;
  font-style: italic;
}
.final-display .separator {
  height: 1px;
  background: linear-gradient(90deg, #0000, #0005, #0000);
  margin: 8px 0;
}
.final-display .total {
  font-size: 1.1rem;
  font-weight: 800;
}

.notes {
  margin-top: 12px;
  color: var(--muted);
  font-size: 0.9rem;
}

@media (max-width: 980px) {
  .calculator {
    grid-template-columns: 1fr;
  }
}

/* Mobile-specific fixes to prevent zoom issues */
@media (max-width: 768px) {
  html {
    -webkit-text-size-adjust: 100%;
    -moz-text-size-adjust: 100%;
    text-size-adjust: 100%;
  }

  .app-root {
    padding: 12px;
    margin: 0;
  }

  input,
  select,
  textarea {
    font-size: 16px !important; /* Prevents iOS zoom on focus */
  }
}

/* keep default overflow behavior; responsive fixes kept elsewhere */

/* Print rules: place the .print-target into one of four quadrants on A4 */
@page {
  size: A4;
  margin: 0;
}

@media print {
  /* hide everything by default */
  body * {
    visibility: hidden;
  }

  /* Make the app-root visible (so its descendants can be selectively
     toggled). Then hide all descendants of app-root â€” we'll reveal only the
     print-target or queued-print elements explicitly. This avoids the issue
     where making a descendant visible has no effect if the ancestor is
     hidden. */
  .app-root {
    visibility: visible;
  }
  .app-root * {
    visibility: hidden;
  }

  /* show only the selected print-target and its children */
  .app-root[data-print] .print-target,
  .app-root[data-print] .print-target * {
    visibility: visible;
  }

  /* Use absolute positioning in print mode. Some mobile browsers (Safari) repeat
     fixed-position elements on every printed page; absolute positioning avoids
     that behavior while still allowing placement into quadrants. Also ensure the
     app-root establishes a containing block for absolute positioning during print. */
  .app-root {
    position: relative;
  }

  .app-root .print-target {
    position: absolute;
    width: 50%;
    height: 50%;
    overflow: hidden;
    box-sizing: border-box;
    padding: 6mm;
    background: white;
    color: black;
    /* avoid breaking the print-target across pages */
    page-break-inside: avoid;
    break-inside: avoid;
  }

  .app-root[data-print="top-left"] .print-target {
    top: 0;
    left: 0;
  }
  .app-root[data-print="top-right"] .print-target {
    top: 0;
    right: 0;
  }
  .app-root[data-print="bottom-left"] .print-target {
    bottom: 0;
    left: 0;
  }
  .app-root[data-print="bottom-right"] .print-target {
    bottom: 0;
    right: 0;
  }

  /* When printing a queued batch, show the queued-print snapshots and
     hide the single .print-target. Each .queued-print occupies one quadrant
     (50% width and 50% height) and will not be split across pages. The
     requested ordering is: pos-1 -> top-right, pos-2 -> top-left,
     pos-3 -> bottom-right, pos-4 -> bottom-left. */
  .app-root[data-print="queue"] .print-target {
    display: none !important;
  }

  /* Use full A4 page for the app-root and implement the 10mm margins as
     internal padding. Setting @page margin to 0 avoids double margin issues
     where printers add their own non-zero printable margins. Using a fixed
     A4 box prevents content from overflowing to a second page. */
  html,
  body {
    margin: 0;
    padding: 0;
    height: 297mm;
  }

  .app-root {
    position: relative;
    width: 210mm;
    height: 297mm;
    padding: 10mm; /* emulate previous @page margins inside the A4 box */
    box-sizing: border-box;
    overflow: hidden;
    page-break-after: avoid;
    page-break-inside: avoid;
  }

  .app-root[data-print="queue"] .queued-print,
  .app-root[data-print="queue"] .queued-print * {
    visibility: visible;
  }

  .app-root .queued-print {
    position: absolute;
    /* occupy half the inner content area. Using 50% of the inner box works
       because .app-root has padding; the absolute child positions are inside
       that padded content box. */
    width: 50%;
    height: 50%;
    box-sizing: border-box;
    padding: 5mm; /* slightly reduced to help avoid overflow */
    overflow: hidden;
    page-break-inside: avoid;
    break-inside: avoid;
    -webkit-print-color-adjust: exact;
    print-color-adjust: exact;
  }

  /* Map requested quadrant order */
  .app-root .queued-print.pos-1 {
    top: 0;
    right: 0;
  }
  .app-root .queued-print.pos-2 {
    top: 0;
    left: 0;
  }
  .app-root .queued-print.pos-3 {
    bottom: 0;
    right: 0;
  }
  .app-root .queued-print.pos-4 {
    bottom: 0;
    left: 0;
  }

  /* Ensure internal print-wrapper inside queued-print uses the same
     formatting and is not scaled or broken across pages */
  .app-root .queued-print .print-wrapper {
    transform: none !important;
    width: 100%;
    height: 100%;
    box-sizing: border-box;
    background: white;
  }

  /* Ensure queued-print elements do not trigger page breaks after themselves */
  .app-root .queued-print {
    page-break-after: avoid;
  }

  /* Full page print: use full paper area (respecting @page margins) */
  .app-root[data-print="full"] .print-target {
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    padding: 6mm;
  }

  /* scale the inner wrapper so content fits the quadrant */
  .app-root .print-target .print-wrapper {
    transform: scale(var(--print-scale, 1));
    transform-origin: top left;
  }

  /* remove shadows and backgrounds that can interfere with printing */
  .app-root .result-item,
  .app-root .final-display {
    box-shadow: none;
    background: transparent;
  }
}
